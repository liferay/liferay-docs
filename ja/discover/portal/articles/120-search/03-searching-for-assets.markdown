---
header-id: searching-for-assets
---

# 資産の検索

<p class="alert alert-info"><span class="wysiwyg-color-blue120">ファストトラック記事は、お客様の利便性のために一部機械翻訳されています。また、ドキュメントは頻繁に更新が加えられており、翻訳は未完成の部分が含まれることをご了承ください。最新情報は都度公開されておりますため、必ず英語版をご参照ください。翻訳に問題がある場合は、<a href="mailto:support-content-jp@liferay.com">こちら</a>までご連絡ください。</span></p>

[TOC levels=1-4]

[検索の概要](/docs/7-1/user/-/knowledge_base/u/search)で説明したように、インデックス付けされたすべてのアセットを検索結果として返すことができます。 開発者は独自のアセットを作成できるため、ご使用のシステムには、デフォルトで組み込まれているもの以外の追加のアセットタイプがある場合があります。

| **ユーザーの検索：** 検索結果でアセットをクリックすると、|アセットパブリッシャーに表示されます（[検索結果]ポートレットで[ *コンテキストで表示* ]オプションが選択されていない場合）。 ただし、ユーザーは異なります。 のことを考える|アセットパブリッシャーでの表示を目的としていない非表示のアセットとして応用。 ユーザーは他のインデックス付きアセットの検索結果として表示されますが、|いずれかをクリックすると、ユーザーのプロフィールページが表示されます。 個人の場合|ページが無効になっている場合、検索結果のリストからユーザーをクリックすると表示されます。あなたは空白のページです。

## 検索バー

ユーザーは検索バーに検索コンテキストを入力します。 ユーザーが検索用語を入力し、 *Enter* ボタンを押す（または虫眼鏡アイコンをクリックする）と、さまざまな検索ウィジェットが展開された [検索ページ](/docs/7-1/user/-/knowledge_base/u/configuring-search-pages) します。

レガシー [検索ポートレット](/docs/7-1/user/-/knowledge_base/u/configuring-search-pages#legacy-search-experience)の検索バーを使用している場合、ユーザーには検索ポートレットの最大化されたビューが表示され、該当する結果とファセットが表示されます。 これらのオプションの詳細については、 [検索ページ](/docs/7-1/user/-/knowledge_base/u/configuring-search-pages#legacy-search-experience) 設定に関する記事を参照してください。

![図1：デフォルトの検索設定では、デフォルトのビューに検索バーが表示され、ユーザーに検索コンテキストの入力を求めます。](../../images/search-bar.png)

### 検索用語を入力する

Liferayの検索インフラストラクチャは、サポートされている検索エンジン（\ [Elasticsearch \]（（<https://www.elastic.co/guide/en/elasticsearch/reference/6.5/full-text-queries.html>）および [Solr](http://lucene.apache.org/solr/features.html)）。

全文検索は、検索クエリに入力されたすべての単語（たとえば、 *space Vacation*）を各インデックスドキュメント内のすべての単語と比較します。 Elasticsearchのような検索エンジンは関連性スコアを計算して、最良の結果が最初に返されるようにし（ブログエントリ *休暇はあなたにぴったりですか？*）、多くの一致する結果が返されます（単語 *Vacation* いずれかが含まれるもの）または *スペース* が返されます）。

全文検索に加えて、高度な検索構文がサポートされています。 @product@はこの動作の基礎となる検索エンジンに依存しているため、詳細については [Elasticsearch](https://www.elastic.co/guide/en/elasticsearch/reference/6.5/query-dsl-query-string-query.html#query-string-syntax) または [Solr](https://lucene.apache.org/solr/guide/6_6/query-syntax-and-parsing.html) ドキュメントを参照してください。

![図2：Elasticsearchのクエリ文字列構文を使用して特定のフィールドのテキストを検索します。](../../images/search-advanced-syntax.png)

### 完全一致のフレーズ：引用検索

ユーザーが検索語（たとえば、 *space Vacation*）に、入力したとおりの完全なフレーズで結果のみを生成させたい場合はどうなるでしょうか。 通常の全文検索では、 *スペースバケーション* 検索すると、 *スペース* および *バケーション*という用語のみを含む検索結果と、両方の用語を含むが他のテキストで区切られたヒット、および完全に一致するフレーズの結果が返されます。 完全に一致するフレーズのヒットのみが返されるようにするには、それを引用符で囲みます： *"space Vacation"*。

![図3：検索語句を引用符で囲んで、完全に一致するフレーズを検索します。 ユーザーが*"space Vacation"*を検索した場合、この結果は返されません。](../../images/search-quoted.png)

### プレフィックス検索

クラシックミュージシャンのサイトを検索している場合は、「 *楽器*という用語を検索します。 この検索では、完全な単語が含まれるドキュメントが返されますが、 *計器* を接頭辞として持つバリアントも返されます。 例えば、との結果 *器具*、 *楽器*、及び *計装* また、返されます。

![図4：* data *を検索すると、* database *も返されます。](../../images/search-prefix.png)

| **注：** プレフィックス検索は、すぐに使用できる多くのフィールドで使用できますが、|検索の振る舞いに関連するほとんどのもので、それは下でより複雑です|フード。 フィールドで使用されるアナライザーを含む、フィールドマッピングの詳細|実行された変換によって、最終的な動作が決まります。

ユーザーに確実に結果を表示するもう1つの方法は、 [検索候補](#search-suggestions)を使用することです。

### 検索バーの構成

ポートレット設定画面で検索バーの動作を設定します。

![図5：構成画面で検索バーの動作を構成します。](../../images/search-bar-configuration.png)

| **注：** 上部にグローバルに埋め込まれた検索バーウィジェットを構成する場合| 1ページの場合、|内のすべてのページでページ上部の検索バーウィジェットを構成します。地点。 また、宛先をオーバーライドします。 [検索ページの](/docs/7-1/user/-/knowledge_base/u/configuring-search-pages) |検索バーポートレット（構成が異なる場合）。 ただし、そうではありません。他のページに手動で配置された検索バーウィジェットを上書きします。

いくつかのオプションがあります：

**キーワードパラメータ名** ：検索で入力したキーワードのパラメータ名を編集します。 たとえば、キーワードterm *data* 検索するときのデフォルトのURLは次のようになります。

    http://localhost:8080/web/guest/search?q=data

キーワードパラメータ名を *キーワード* に変更すると、次のようになります。

    http://localhost:8080/web/guest/search?keyword=data

**スコープ** ：3つのオプションから選択します：このサイト（デフォルト）、すべて、およびユーザーに選択させます。 *このサイト* は、検索が実行されるサイトに関連付けられているアセットのみが検索されることを意味します。 *Everything*選択して、検索範囲をすべてのサイトに拡大します。 ユーザーが検索するスコープを選択できるようにするには、[ *ユーザーに*選択させる]を選択します。

![図6：検索を実行するスコープをユーザーに選択させます。](../../images/search-scope.png)

**スコープパラメータ名** ：検索が行われているスコープのURLパラメータ名を設定します。 このパラメーターは、スコープ *ユーザーに* を選択させるが選択されている場合にのみURLに表示されます。 デフォルト値は *スコープ*なので、ワード *データ* を検索すると、デフォルトURLが生成されます。

    http://localhost:8080/web/guest/search?q=data&scope=this-site

*スコープ* を *ターゲット* 変更すると、次のURLが生成されます。

    http://localhost:8080/web/guest/search?q=data&target=this-site

**デスティネーションページ** ：に優しいURLを提供する [検索ページ](/docs/7-1/user/-/knowledge_base/u/configuring-search-pages)。 構成されていない場合、または存在しないページを指している場合、ユーザーに表示するには検索バーを構成する必要があるというメッセージが管理者に表示されます。

**高度な検索構文を使用** ：Elasticsearchを使用している場合、これを有効にすると、ユーザーは [クエリ文字列構文](https://www.elastic.co/guide/en/elasticsearch/reference/6.5/query-dsl-query-string-query.html#query-string-syntax) を検索バーに入力できます。 Solrを使用している場合は、 [適切な構文についてそのドキュメントを参照してください](https://lucene.apache.org/solr/guide/6_6/query-syntax-and-parsing.html)。

## 検索候補

最初のクエリが最適ではない場合、ユーザーに検索語句を提案します。 スペルチェック設定を使用すると、管理者は検索アプリケーションを構成して、ユーザーが多くの結果を返さない検索語（たとえば、スペルが少し間違っている）を入力した場合、ユーザーに検索を改善するように求めることができます。

スペルチェック設定を構成するには、

1.  まず、スペルチェックインデックスのインデックスを再作成する必要があります。 *コントロールパネル* → *構成* → *検索*に移動し、 *実行* 横にある *クリックします。すべてのスペルチェックインデックスを再インデックスします*。

2.  検索ページに提案ウィジェットを追加します。

3.  設定画面を開きます。 ウィジェットの[オプション]ボタン（![Options](../../images/icon-app-options.png)）をクリックし、[ *構成*]を選択します。

![図7：ユーザーの入力ミスを許容し、ユーザーを結果に導くのに役立つ提案設定を構成します。](../../images/search-suggestions.png)

ここには3つの主要な設定があります。

**検索結果の数がしきい値を超えている場合は、「もしかして...」と表示します。** ：検索で最小数（デフォルトでは50）の結果が返されなかった場合に、スペルチェックされた検索クエリをユーザーに提示します。

**関連クエリを表示** ：検索結果の数が指定したしきい値（デフォルトでは50）を満たしていない場合は、最大数の代替クエリ（デフォルトでは10）まで表示します。

**成功したクエリに基づいて新しい関連クエリを追加する** ：結果の最小数（デフォルトでは50）を生成する場合は、ユーザーの検索クエリにインデックスを付けて、候補としてユーザーに表示できるようにします。 [関連クエリを表示]設定を有効にすると、十分な結果が得られない類似の検索クエリの関連クエリとして使用されます。
