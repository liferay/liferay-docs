---
header-id: defining-metrics
---

# メトリックの定義

<p class="alert alert-info"><span class="wysiwyg-color-blue120">ファストトラック記事は、お客様の利便性のために一部機械翻訳されています。また、ドキュメントは頻繁に更新が加えられており、翻訳は未完成の部分が含まれることをご了承ください。最新情報は都度公開されておりますため、必ず英語版をご参照ください。翻訳に問題がある場合は、<a href="mailto:support-content-jp@liferay.com">こちら</a>までご連絡ください。</span></p>

[TOC levels=1-4]

マーケティングチームにユーザーからの実際のフィードバックを提供するために、 *メトリック*を使用して追跡するユーザーアクションを定義できます。 指標はレポートで使用され、特定のユーザーアクションを追跡することでキャンペーンの効果を測定します。

指標は、オーディエンスターゲティング分析エンジンによって収集された分析データをフィルタリングして、ユーザーとそのユーザーセグメントによって特定の要素またはコンテンツに対して特定のアクションが実行された回数を取得します。

メトリックは開発者によって作成され、拡張機能としてデプロイされます。 デフォルトでは、オーディエンスターゲティングには、最も一般的なユーザーアクションを追跡するための指標が含まれています。 これらのメトリックについては、以下で説明します。

### コンテンツ

コンテンツが表示された回数を追跡します。 コンテンツセレクターを使用して、追跡するコンテンツを設定します。

### ページ

選択したページが表示された回数を追跡します。 パブリックページとプライベートページの両方のビューを追跡できます。

### 形

フォームを表示したユーザー、フォームを操作したユーザー（入力の値を入力または選択したユーザー）、送信したユーザーの数を追跡します。 *Event type* フィールドから *All* オプションを選択すると、カスタムレポートには3つのイベントの数値が同時に表示されます。 追跡するフォームも指定する必要があります。これは、 *Form* メトリックから選択できます。

### リンク

リンクがクリックされる頻度を追跡します。 これは、キャンペーン管理者が十分に表示されているか役立つかを判断するのに役立ちます。

フォームと同様に、追跡するリンクのIDを提供する必要があります。 わからない場合は、リンクのあるページのHTMLを調べて、この情報を抽出できます。

### ユーチューブの動画

ユーザーが埋め込まれたYouTube動画をどのように操作するかを追跡します。 動画のIDを入力する必要があります。 このIDをビデオURLから `v` パラメータの値として抽出できます。 たとえば、URL `https://www.youtube.com/watch?v=2EPZxIC5ogU` では、YouTube動画IDは `2EPZxIC5ogU`です。 次に、使用可能なイベントの1つを選択するか、 *すべて* を選択してそれらすべてを追跡します。 これらのイベントの意味の詳細については、公式のYouTube APIドキュメントをご覧ください。

このオプションは、YouTubeビデオがiframeとして埋め込まれている場合にのみ機能することに注意してください。 iframeコードは、YouTubeビデオの *Share* → *Embed* メニューから入手できます。

## メトリックの使用

会社が来月開催するイベントのキャンペーンを実行するとします。 YouTubeビデオと *Register Now* バナーを含むイベントのメインページを作成しました。 また、イベントに関するブログエントリがいくつかの異なるページに表示され、登録ページに登録の支払いフォームが表示されます。 このキャンペーンの目標は、できるだけ多くの人に登録してもらうことですが、すべてが期待どおりに機能していることを確認するために追跡したいその他の情報があります。

  - イベントのメインページへのアクセス
  - クリックしてビデオを表示
  - 最後まで動画を視聴したユーザーの数
  - 「今すぐ登録」バナーをクリックします
  - イベントに関するブログエントリのビュー
  - 登録フォームのビュー
  - 登録フォームへの入力を開始したユーザーの数
  - 登録を完了したユーザーの数

次のセクションで詳しく説明するように、指標をキャンペーンレポートに割り当てることができます。 指標パレットにアクセスするには、

1.  既存のキャンペーンに移動します。

2.  [ *レポート* ]タブを選択します。

3.  カスタムレポートを追加します。

    指標パレットには、 *New Report* ウィザードの下部からアクセスできます。

パレットから *メトリック* ドラッグアンドドロップして、上記のすべてのアクションを追跡できます。 開発者はより多くのタイプのメトリックを作成し、OSGiプラグインとしてデプロイできます。 詳細については、 [オーディエンスターゲティングによるユーザーアクションのトラッキング](/docs/7-1/tutorials/-/knowledge_base/t/tracking-user-actions-with-audience-targeting) チュートリアルをご覧ください。

### オーディエンスターゲティング分析

指標は、サイトごとまたは@product@インストールごとに構成できる *Audience Targeting Analytics* エンジンを使用します。

1.  サイトごとに分析エンジンを構成するには、[サイトの管理]に移動し、[ *構成* ]→[ *サイト設定* ]→[ *詳細* ]→[ *オーディエンスターゲティング分析*]をクリックします。

2.  ポータルインスタンスごとに構成するには、 *コントロールパネル* → *構成* → *システム設定* → *オーディエンスターゲティング分析*ます。

次の分析オプションを使用できます。

  - 匿名ユーザー（サイトごとに利用不可）
  - ページ
  - コンテンツ
  - フォーム
      - フォームビュー
      - フォームの相互作用
      - フォーム送信
  - リンク集
  - ユーチューブの動画

すべてのユーザーのすべてのアクションを追跡することは、サーバーにとって大きな負荷になる可能性があります。 したがって、情報が不要なアクションの追跡を無効にすることをお勧めします。 たとえば、デフォルトでは、ゲストの行動分析が追跡されます。 これにより、データベースに大量のデータが保存されます。 ゲストユーザーの追跡に興味がない場合は、

1.  *Anonymous Users* セレクターを無効にし* 。</p></li>

2

[ *保存*クリックします。</ol>

匿名ユーザーデータを収集する必要があるが、データベースリソースにまだ注意している場合は、匿名データをクリーンアップする頻度の間隔を変更できます。 匿名データストレージの設定は、 *オーディエンスターゲティングサービス*ます。

  - **チェック間隔** および **チェック時間単位** は、データのクリーンアップが行われる頻度を定義します。 間隔が *1* 設定され、単位が *日* 設定されている場合、クリーンアップタスクは1日に1回発生します。

  - **最大経過時間** および **最大経過時間単位** は、削除するデータの古さを定義するため、クリーンアップタスクの直前に作成されたデータはすぐには削除されません。 経過時間が *10* 設定され、単位が *時間*設定されている場合、10時間より古いデータは削除され、10時間未満のデータは次のクリーンアップまで保持されます。

![図1：ここで匿名データのクリーンアップを管理できます。](../../images-dxp/anonymous-users-analytics.png)

特定のエンティティの分析を無効にすると、追跡されなくなります。 アナリティクスを慎重に管理して、オーディエンスターゲティングのエクスペリエンスを最適化します。

また、分析データを個別のデータベーススキーマに保存して、独立したスケーラビリティを実現することもできます。 分析データのストレージをLiferayのデータベーススキーマから分離するには、

1.  コントロールパネルに移動します→ *構成* → *システム設定* → *Web Experience*

2.  *オーディエンスターゲティングアナリティクスストレージ*選択し* 。</p></li>

3

別のデータベーススキーマを指すように外部ストレージフィールドに入力します。</ol>

![図2：外部ストレージ要件に記入することで、オーディエンスターゲティング分析データが代替データベーススキーマに保存されるように設定します。](../../images-dxp/alternative-analytics-db.png)

外部データソース設定を保存したら、Audience Targeting Analyticsコンポーネントを再起動する必要があります。

1.  コントロールパネル→ *アプリ* → *アプリマネージャー* に移動し、 *Liferay Audience Targeting* アプリスイートを選択します。

2.  Analyticsコンポーネントの[ *オプション* （![Options](../../images-dxp/icon-app-options.png)）]ボタンを選択し、[ *アクティブ化*]をクリックします。

3.  アナリティクスコンポーネントの[ *オプション* （![Options](../../images-dxp/icon-app-options.png)）]ボタンを再度選択し、[ *アクティブ化*]をクリックします。
