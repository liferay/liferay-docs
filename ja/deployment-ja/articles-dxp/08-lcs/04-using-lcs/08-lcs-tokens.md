# 環境トークンについて[](id=understanding-environment-tokens)

サーバーを環境に登録するには、その環境のトークンファイルを使用する必要があります。LCS管理者と環境管理者はこのファイルを作成し配布することができます。これには、LCSクライアントアプリがサーバーを環境に登録するために必要なすべての情報が含まれています。サーバーは起動時にトークンを使用してLCSに接続します。アクティベーションにLCSを使用する場合、サーバーは接続時に環境のサブスクリプションからアクティベーションキーを自動的に使います。これにより、インタラクションなしで、立ち上げ時にサーバーを自動的にアクティベートすることができます。

+$$$

**注：**ご使用の環境トークンの使用方法と管理方法については、[registering your server with LCS](/discover/deployment/-/knowledge_base/7-1/activating-your-liferay-dxp-server-with-lcs)を参照してください。

$$$

環境トークンを使用する際に注意しなければならないことがいくつかあります：



- 各環境は、1つのトークンファイルしか持てません。トークンを再生成すると、古いファイルを使用しているサーバはLCSから切断され、新しいファイルを受信するまで再接続できません。
トークンの再生成が原因でサーバが切断され、バージョン4.0.2以降のLCS​​クライアントアプリケーションを実行している場合、サーバーは30日間の猶予期間に入り、その間に正常に機能します。
これにより、管理者は新しいトークンファイルを使用してLCSに再接続することができます。以前のバージョンのLCSクライアントアプリケーションを実行しているサーバーは、管理者が新しいトークンで再接続するまでユーザーにエラーページを表示します。

- トークンファイルを配布する時、誰でもあなたの環境に接続できるようになるので注意してください（そしてLCSをアクティベーションに使っているならサブスクリプションでアクティベーションキーを消費してください）。



- 最小限の情報（サーバー名、場所など）を使用してサーバーをLCSに登録します。この情報は[LCSのサーバービュー](/discover/deployment/-/knowledge_base/7-1/managing-lcs-servers)からいつでも変更できます。



- 環境トークンはOAuthを使用して接続します。環境トークンを使用すると、OAuth認証サイクルが無効になります。LCS管理者または環境管理者がLCSにサーバーを登録したことがない場合は、最初に登録したときに、OAuth許可エントリーがLCSに作成されます。以前にLCSにサーバーを登録したことがある場合は、トークンファイルを作成するときに既存の資格情報が使用されます。

- トークンを作成したLCSユーザーの資格情報が無効になった場合は、新しいトークンを作成し、それを使用してLCSに再接続する必要があります。ユーザーがLCSプロジェクトを終了するか、別の環境でLCS 環境マネージャーまたはLCS 環境ビュアーになると、LCSユーザーの資格情報は無効になります。



このようなことが起きる中、どうして環境トークンを使用するかというと、LCS接続プロセスを単純化することに加えて、環境トークンは、アルゴリズムが自動的にサーバーを作成および破棄する自動スケーリング環境では価値があるからです。この状況では、自分自身をアクティベートできて設定できるクライアントを持つことが非常に重要です。

+$$$

**注**：自動スケーリング環境が新しいサーバーノードをシステムイメージ内のサーバーから作成した場合、セットアップ中にそのサーバーは人とのインタラクションを行うことができません。そのようなイメージを作成するときは、自動セットアップを妨げるポータルプロパティの設定を変更する必要があります。デフォルトでは、@product@のセットアップウィザードは人とのイントラクションを必要とします。したがって、自動スケーリング環境にサーバーから新しいノードを作らせたい場合、`setup.wizard.enabled`を`無し`に設定する必要があります。

$$$
